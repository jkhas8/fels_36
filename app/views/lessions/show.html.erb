<% provide(:title, "Lession|#{@lession.category.name}") %>
<div class="row">
  <% if @lession.learned %>
    <%= content_tag :p,"You have " +
      pluralize(@lession.check_correct_answer, "correct answer"),
      class: "correct" %>
  <% end %>
  <%= form_for @lession, method: :patch do |f| %>
    <% @lession.results.each_with_index do |result, i| %>
      <%= content_tag :div, class: i == 0 ? "question current" : "question",
        id: result.word.id do %>
        <%= content_tag :p,
          "#{@lession.category.name} #{i+1}/#{@lession.results.count}" %>
        <table><tr>
          <td style="padding-right:30px">
            <span class="word"><%= result.word.content %></span><br />
          </td>
          <td>
            <%= f.fields_for :results, result do |builder| %>
              <% result.word.answers.shuffle.each do |answer| %>
                <%= builder.radio_button :answer_id, answer.id,
                  disabled: @lession.learned %>
                <%= builder.label :answer_id, answer.content, value: answer.id,
                  class: answer.correct && @lession.learned ?
                  "correct" : "" %>
                <br />
              <% end %>
            <% end %>
            <% if i == 19 %>
              <%= button_tag "Submit", type: "submit", disabled: @lession.learned %>
            <% else %>
              <%= button_tag "Next", type: "button", onclick: "show_questions()" %>
            <% end %>
          </td>
        </tr></table>
      <% end %>
    <% end %>
  <% end %>
</div>
